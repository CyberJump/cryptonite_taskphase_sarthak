
# WEB EXPLOITATION

This will deals with all the challenges and resources which i have used to clear the ctfs related to WEB EXPLOITATION.
# 1) Cookies
So this challenge is rated easy in web exploitation part of picoCTF.A link to the website from which we have to extract flag is given.
![Screenshot 2024-11-09 171516](https://github.com/user-attachments/assets/e11b65ad-55d8-4e89-ae19-66308115f959)

so when we first open the website we are given a search bar and lightly written snickerdoodle in the text bar.
![image](https://github.com/user-attachments/assets/983d9f9b-d5fa-441e-96f9-387e95677bb5)
soo my first thought process was obviously write snickerdoodle in it and see what happens.so when i wrote snickerdoodle in it,I was redirected to the next page which was saying "I love snickerdoodle cookies".I noticed a change in the url of website with an additional /check was added.
![image](https://github.com/user-attachments/assets/aa278dd9-5e32-4831-9808-7f7a76167473)
I honestly didnt know whats snickerdoodle is so searched up google for whats snicker doodle and found out its a type of cookie.This struck something in my head but before i went back to home page tried inspecting page for the cookies present.
Indeed, there was a cookies with a value -1.
![image](https://github.com/user-attachments/assets/d4c540ee-0a09-4a4d-a03d-b37a227786f5)
so i was curious again, so what i did was i typed in snickerdoodle again and checked the cookie again and there was a change in value of cookies. it went from -1 to 0.
![image](https://github.com/user-attachments/assets/3fd6fe21-a7e1-44a2-88ad-2c7a973333a7)
Well then i searched up all the types of cookies on google. then i got some results.-
https://www.allrecipes.com/gallery/most-popular-types-of-cookies/

From this website i tried butter cookie on the search bar on home page and i observed the cookies again.
![image](https://github.com/user-attachments/assets/6a9d5a16-beb2-4b67-8417-1759933022ba)
This means for each cookie type,there was a particular value of cookie.Now here i went on a tangent. I got it that by changing the value of cookie we can get flag but i didnt wanna bruteforce it.I tried to make a python script which will automate it.

so i searched web to find a way to make a python script to change cookie value and the websites i used were-
https://stackoverflow.com/questions/27644296/python-setting-cookie-into-another-website

https://dhruvadave5297.medium.com/how-i-use-python-to-collect-cookies-urls-and-other-data-from-any-website-6ee97f4cafc9

Just from viewing these websites i thought that these are kinda tricky to implement. So i kept this approach as plan b and went for bruteforce first.

I typed in snickerdoodle and change the cookie value from 0 to 1 then refreshed the website and saw that it went from i love snickerdoodle to i love chocolate chip cookies.
![image](https://github.com/user-attachments/assets/7ae186ce-7759-45b0-bd5d-d8872b85300e)

well then i just went on a bruteforce spree and by changing the cookies value one by one. It took me 4-5 min of bruteforcing but then i got to picoctf cookie which had the value 18.
![image](https://github.com/user-attachments/assets/775cfd95-97da-4b92-9997-8a91a6d3f151)
VOILA, I GOT THE FLAG!!!!

# 2) SOAP

Upon booting up this challenge, I checked the hint for this challenge that was XML external entity 
![image](https://github.com/user-attachments/assets/c1c016c8-21bf-418d-bffd-6214d3f10e5b)

So i Started to go about researching it. I searched up XXE injection and stumbled upon a great resource by portswigger.

website-https://portswigger.net/web-security/xxe

From this website i learned about XML files \
-what is XML files\
-How to define XML DTD and entity defination\
-What is external entity and internal entity\

I found this particular section really relevant to my EXPLOITATION
![image](https://github.com/user-attachments/assets/70dee5d4-5e01-4830-bd37-2e1b7e07ffd1)

then I explored a lab related to it and got hold of a great video tutorial explaining how to use burp suite to XML exploitation to retrive a file's content.

video link-https://www.youtube.com/watch?v=0DQnWalxYb4

Alright then after getting all the knowledge about how to use this exploit. I boot up burp suite and examined the website.

![image](https://github.com/user-attachments/assets/5c398717-2672-48ff-89b7-13f24bd86f92)

I realised that when we clicked on details, there must be request to server to post the information about this particular section. 

I opened burp suite to see what happens when I click on details.
![image](https://github.com/user-attachments/assets/24868add-ea79-4ed5-ba77-75cd50c6e91b)

surely enough there was a post request sent. so i forwared this request to repeater and examined the request. well it was pretty evident that it was XML request, which requested data from ID=1 .
I then thought about deploying a payload with the system entity conatining the data of /etc/passwd.
![image](https://github.com/user-attachments/assets/633d9ff8-8180-4941-8831-f6de7ccae43c)
so I did a DTD with an external entity passwd containing the file /etc/passwd. Now instead of fetching the data from ID=1 it would get the data for passwd entity. I sent the request.
![image](https://github.com/user-attachments/assets/e0dc68c1-4427-4d3f-a2f6-e83b389c5d1a)

This is the response i got back and we can see that it contains the contents of /etc/passwd with at the end the Pico flag required.

# 3) Forbidden Paths

Well upon checking the problem statement of this Challenge. I noticed that something is referenced about filtering absolute path and I have to bypass it.
![image](https://github.com/user-attachments/assets/42287eab-fc3d-4581-9628-fdb360783988)

well upon opening the website link, it was website which would fetch the data from the files searched and show the data.
![image](https://github.com/user-attachments/assets/fdbd8c88-57b9-494e-8575-1069e684bf3a)
 Some file names were given above the search box so fidled with them and searched for one of them.
 ![image](https://github.com/user-attachments/assets/f475c219-03e4-416a-ad6d-b917c7cc36b2)
From the looks of it just printed out everthing written in the file.

So I start to search on about absolute file path filetering and how to get pass it

website-https://portswigger.net/web-security/file-path-traversal#what-is-path-traversal

This website helped me understand about file transversal and how to move up and down the directories using relative file paths.

Anyways I booted up Burp Suite and targetted this website.
I again searched up the file in search bar and got a post request.
I forwarded this to repeater and check the parameters.
![image](https://github.com/user-attachments/assets/9ed46262-7300-4b3a-80ba-2ce7d8f91ec8)

![image](https://github.com/user-attachments/assets/3b956acb-dc06-41fa-b4f9-4766bd828fb1)

So i opened up the request body parameters, where it was file name which was to be read and the process which had to be carried out.
![image](https://github.com/user-attachments/assets/5230eb6f-b6b8-46d3-a79b-823547d0c592)
 well i then tweaked the file name by using relative file path to go various directories up and get the file /flag.txt

![image](https://github.com/user-attachments/assets/b33641e3-c5d5-4539-ac73-0f114440abd8)

well then i sent this request to the server and got the response.
![image](https://github.com/user-attachments/assets/0522fc2d-c23d-4db6-a7fe-0efa6b039bef)

VOILAAAA!!! got the flag.

# 4)SQLiLite

So I have known something about sql injection but i didnt have the complete understanding.
![image](https://github.com/user-attachments/assets/d6670b5f-57cd-4d04-9eef-bb1fc8af6df3)

Well so i did some research online about SQL injection works- 
I got some great resource online about this\
Resources 1-https://portswigger.net/support/using-sql-injection-to-bypass-authentication

Resource 2-https://www.w3schools.com/sql/sql_injection.asp

From what i understood that i have to somehow construct a attribute to fill in to make the sql query fetch the admin login 

I started up the chall and i was greeted with a login page. So i tried putting user and passwd to see what i will get.
![image](https://github.com/user-attachments/assets/440962f4-3c3c-44ba-b6a3-91ea3bf78d34)

the sql query here is now revealed so now i tried few iterations to bypass it.

1st iteration- user OR 1=1 

![image](https://github.com/user-attachments/assets/2f81018e-de6b-4a2e-993a-d860044fbef7)

i observed that OR statement isnt properly functioning because of positioning of ' so tried to make a new approach

2nd iteration- user' OR '1=1


![image](https://github.com/user-attachments/assets/eefe9ccb-e5b2-4508-b750-3a7a5bd86a33)

woah i got luckyy, and i got logged in and it said that its in plainsight. So I inspected the page and got the flag.

![image](https://github.com/user-attachments/assets/30d2d1d9-a7c7-4338-acf2-a4834d291be3)

well well here we have the flag and the flag is 

```
picoCTF{L00k5_l1k3_y0u_solv3d_it_ec8a64c7}

```
VOILAAAAA ðŸ¥³ðŸ¥³



